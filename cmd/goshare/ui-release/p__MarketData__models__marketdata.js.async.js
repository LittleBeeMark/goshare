(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{aGpL:function(t,e,a){"use strict";a.r(e);var n=a("gWZ8"),r=a.n(n),o=a("p0pE"),c=a.n(o),i=a("d6i3"),p=a.n(i),s=a("dCQc"),l=function(t){var e=t.toString().split(".");return e.length>1?e[1].length:0},d=function(t){return t.time=1e3*t.time,t.digits=l(t.priceTick),t.price=t.price.toFixed(t.digits),t.preSettlementPrice>0?(t.upDownRatio=(t.price-t.preSettlementPrice)/t.preSettlementPrice,t.upDownRatio=(100*t.upDownRatio).toFixed(2)):t.upDownRatio="--",t.preSettlementPrice=t.preSettlementPrice.toFixed(t.digits),t};e["default"]={namespace:"marketdata",state:{ws:0,list:[],filter:{exchange:-1},mainContract:[]},effects:{fetchMainContract:p.a.mark(function t(e,a){var n,r,o,c,i;return p.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.payload,r=e.callback,o=a.call,c=a.put,t.next=4,o(s["f"],n);case 4:if(i=t.sent,i.success&&i.data){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,c({type:"setMainContract",payload:i.data});case 9:r&&r(i.data);case 10:case"end":return t.stop()}},t)}),fetch:p.a.mark(function t(e,a){var n,r,o,c;return p.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.payload,r=a.call,o=a.put,t.next=4,r(s["e"],n);case 4:return c=t.sent,t.next=7,o({type:"save",payload:c.data});case 7:case"end":return t.stop()}},t)})},reducers:{updateState:function(t,e){var a=e.payload;return c()({},t,a)},setMainContract:function(t,e){for(var a=0;a<e.payload.length;a++)e.payload[a]=d(e.payload[a]),e.payload[a].index=a+1;return e.payload.sort(function(t,e){return e.prePosition-t.prePosition}),console.log(e.payload),c()({},t,{mainContract:e.payload})},save:function(t,e){for(var a=0;a<e.payload.length;a++)e.payload[a].index=a+1;return c()({},t,{list:e.payload})},onTick:function(t,e){var a=e.payload,n=r()(t.mainContract),o=n.findIndex(function(t){return t.symbol.exchange===a.symbol.exchange&&t.symbol.code===a.symbol.code});return"SSE"==a.symbol.exchange&&console.log("Received Message: "+"".concat(a.price," ").concat(a.symbol.exchange),o),o>=0&&(a.index=o+1,n[o]=a),c()({},t,{mainContract:n})}},subscriptions:{setupHistory:function(t){var e=t.dispatch,a=t.history;a.listen(function(t){console.log(t.pathname,t.pathname.indexOf("marketdata/main-contract")),t.pathname.indexOf("marketdata/main-contract")>0&&e({type:"fetchMainContract",payload:0,callback:function(t){}})})}}}}}]);